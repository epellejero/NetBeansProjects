DROP DATABASE IF EXISTS libreria;
CREATE DATABASE libreria CHARACTER SET utf8mb4;
USE libreria;

CREATE TABLE IF NOT EXISTS autor (
  ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  ALTA BOOLEAN NOT NULL,
  NOMBRE VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS editorial (
	ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ALTA BOOLEAN NOT NULL,
	NOMBRE VARCHAR(50) NOT NULL
	);
  
CREATE TABLE IF NOT EXISTS libro (
	ISBN INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    ALTA BOOLEAN NOT NULL,
    ANIO INT,
    EJEMPLARES INT,
    EJEMPLARESRESTANTES INT,
    EJEMPLARESPRESTADOS INT,
    TITULO VARCHAR(100) NOT NULL,
    AUTOR_ID INT NOT NULL,
    FOREIGN KEY (AUTOR_ID) REFERENCES AUTOR(ID),
    EDITORIAL_ID INT NOT NULL,
	FOREIGN KEY (EDITORIAL_ID) REFERENCES EDITORIAL(ID)
);

CREATE TABLE IF NOT EXISTS cliente (
  ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  DOCUMENTO INT NOT NULL,
  NOMBRE VARCHAR(50) NOT NULL,
  APELLIDO VARCHAR(30) NOT NULL,
  TELEFONO VARCHAR(20)
);

CREATE TABLE IF NOT EXISTS prestamo (
  ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  FECHAPRESTAMO DATE NOT NULL,
  FECHADEVOLUCION DATE NOT NULL,
  LIBRO_ISBN INT NOT NULL,
  FOREIGN KEY (LIBRO_ISBN) REFERENCES LIBRO(ISBN),
  CLIENTE_ID INT NOT NULL,
  FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID)
);

INSERT INTO AUTOR VALUES('201', TRUE, 'GEORGE WELLS');
INSERT INTO AUTOR VALUES('202', TRUE, 'H. P. LOVECRAFT');
INSERT INTO AUTOR VALUES('203', TRUE, 'GEORGE ORWELL');
INSERT INTO AUTOR VALUES('204', TRUE, 'RAY BRADBURY');
INSERT INTO AUTOR VALUES('205', TRUE, 'RICHARD MATHERSON');
INSERT INTO AUTOR VALUES('206', TRUE, 'ISAAC ASIMOV');
INSERT INTO AUTOR VALUES('207', TRUE, 'ALFRED BESTER');
INSERT INTO AUTOR VALUES('208', TRUE, 'STANISLAW LEM');
INSERT INTO AUTOR VALUES('209', TRUE, 'FRANK HERBERT');
INSERT INTO AUTOR VALUES('210', TRUE, 'KURT VONNEGUT');
INSERT INTO AUTOR VALUES('211', TRUE, 'PHILIP K. DICK');
INSERT INTO AUTOR VALUES('212', TRUE, 'URSULA K. LE GUIN');
INSERT INTO AUTOR VALUES('213', TRUE, 'JOANNA RUSS');
INSERT INTO AUTOR VALUES('214', TRUE, 'DOUGLAS ADAMS');
INSERT INTO AUTOR VALUES('215', TRUE, 'WILLIAM GIBSON');
INSERT INTO AUTOR VALUES('216', TRUE, 'MARGARET ATWOOD');
INSERT INTO AUTOR VALUES('217', TRUE, 'OCTAVIA E. BUTTER');
INSERT INTO AUTOR VALUES('218', TRUE, 'DAN SIMMONS');
INSERT INTO AUTOR VALUES('219', TRUE, 'NEAL STEPHENSON');
INSERT INTO AUTOR VALUES('220', TRUE, 'KIM STANLEY ROBINSON');
INSERT INTO AUTOR VALUES('221', TRUE, 'TED CHIANG');
INSERT INTO AUTOR VALUES('222', TRUE, 'LIU CIXIN');
INSERT INTO AUTOR VALUES('223', TRUE, 'DMITRY GLUKHOVSKY');
INSERT INTO AUTOR VALUES('224', TRUE, 'ANN LECKIE');
INSERT INTO AUTOR VALUES('225', TRUE, 'CARL SAGAN');
INSERT INTO AUTOR VALUES('226', TRUE, 'H. G. WELLS');
INSERT INTO AUTOR VALUES('227', TRUE, 'ORSON SCOTT CARD');
INSERT INTO AUTOR VALUES('228', TRUE, 'HÉCTOR GERMÁN OESTERHELD');
INSERT INTO AUTOR VALUES('229', TRUE, 'JULIO VERNE');

INSERT INTO editorial VALUES('5001', TRUE, 'COLUMBIA');
INSERT INTO editorial VALUES('5002', TRUE, 'LIBERTAD');
INSERT INTO editorial VALUES('5003', TRUE, 'AURORA');
INSERT INTO editorial VALUES('5004', TRUE, 'SALVAT');

INSERT INTO libro VALUES('2001', TRUE, 1895, 3, 0, 3, 'LA MAQUINA DEL TIEMPO', '201', '5001');
INSERT INTO libro VALUES('2002', TRUE, 1936, 3, 0, 3, 'EN LAS MONTAÑAS DE LA LOCURA', '202', '5001');
INSERT INTO libro VALUES('2003', TRUE, 1949, 3, 0, 3, '1984', '203', '5001');
INSERT INTO libro VALUES('2004', TRUE, 1953, 3, 0, 3, 'FAHRENHEIT 451', '204', '5001');
INSERT INTO libro VALUES('2005', TRUE, 1954, 3, 0, 3, 'SOY LEYENDA', '205', '5001');
INSERT INTO libro VALUES('2006', TRUE, 1955, 3, 0, 3, 'EL FIN DE LA ETERNIDAD', '206', '5001');
INSERT INTO libro VALUES('2007', TRUE, 1956, 3, 0, 3, 'LAS ESTRELLAS, MI DESTINO', '207', '5001');
INSERT INTO libro VALUES('2008', TRUE, 1961, 3, 0, 3, 'SOLARIS', '208', '5001');
INSERT INTO libro VALUES('2009', TRUE, 1965, 3, 0, 3, 'DUNE', '209', '5001');
INSERT INTO libro VALUES('2010', TRUE, 1969, 3, 0, 3, 'MATADERO CINCO', '210', '5001');
INSERT INTO libro VALUES('2011', TRUE, 1969, 3, 0, 3, 'UBIK', '211', '5001');
INSERT INTO libro VALUES('2012', TRUE, 1969, 3, 0, 3, 'LA MANO IZQUIERDA DE LA OSCURIDAD', '212', '5001');
INSERT INTO libro VALUES('2013', TRUE, 1975, 3, 0, 3, 'EL HOMBRE HEMBRA', '213', '5001');
INSERT INTO libro VALUES('2014', TRUE, 1979, 3, 0, 3, 'GUIA DEL AUTOESTOPISTA GALÁCTICO', '214', '5001');
INSERT INTO libro VALUES('2015', TRUE, 1984, 3, 0, 3, 'NEUROMANTE', '215', '5001');
INSERT INTO libro VALUES('2016', TRUE, 1985, 3, 0, 3, 'ELCUENTO DE LA CRIADA', '216', '5001');
INSERT INTO libro VALUES('2017', TRUE, 1985, 3, 0, 3, 'AMANECER', '217', '5001');
INSERT INTO libro VALUES('2018', TRUE, 1989, 3, 0, 3, 'HYPERION', '218', '5001');
INSERT INTO libro VALUES('2019', TRUE, 1992, 3, 0, 3, 'SNOW CRASH', '219', '5001');
INSERT INTO libro VALUES('2020', TRUE, 1992, 3, 0, 3, 'MARTE ROJO', '220', '5001');
INSERT INTO libro VALUES('2021', TRUE, 2002, 3, 0, 3, 'LA HISTORIA DE TU VIDA', '221', '5001');
INSERT INTO libro VALUES('2022', TRUE, 2006, 3, 0, 3, 'EL PROBLEMA DE LOS TRES CUERPOS', '222', '5001');
INSERT INTO libro VALUES('2023', TRUE, 2009, 3, 0, 3, 'METRO 2034', '223', '5001');
INSERT INTO libro VALUES('2024', TRUE, 2013, 3, 0, 3, 'JUSTICIA AUXILIAR', '224', '5001');
INSERT INTO libro VALUES('2025', TRUE, 1895, 3, 0, 3, 'CONTACTO', '225', '5001');
INSERT INTO libro VALUES('2026', TRUE, 1895, 3, 0, 3, 'YO, ROBOT', '206', '5001');
INSERT INTO libro VALUES('2027', TRUE, 1895, 3, 0, 3, 'LA GUERRA DE LOS MUNDOS', '226', '5001');
INSERT INTO libro VALUES('2028', TRUE, 1895, 3, 0, 3, 'CRONICAS MARCIANAS', '204', '5001');
INSERT INTO libro VALUES('2029', TRUE, 1895, 3, 0, 3, 'EL JUEGO DE ENDER', '227', '5001');
INSERT INTO libro VALUES('2030', TRUE, 1957, 3, 0, 3, 'EL ETERNAUTA', '228', '5001');
INSERT INTO libro VALUES('2031', TRUE, 1930, 3, 0, 3, '20.000 LEGUAS DE VIAJE SUBMARINO', '229', '5004');

SELECT * FROM AUTOR;
SELECT * FROM editorial;
SELECT * FROM LIBRO;
SELECT * FROM LIBRO L JOIN AUTOR A ON L.AUTOR_ID = A.ID;
